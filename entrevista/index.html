<!doctype html>

<!--
    
    So you'd like to know how to use impress.js?
    
    You've made the first, very important step - you're reading the source code.
    And that's how impress.js presentations are built - with HTML and CSS code.
    
    Believe me, you need quite decent HTML and CSS skills to be able to use impress.js effectively.
    And what is even more important, you need to be a designer, too, because there are no default
    styles for impress.js presentations, there is no default or automatic layout for them.
    
    You need to design and build it by hand.
    
    So...
    
    Would you still like to know how to use impress.js?
    
-->

<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1024" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>Història d'una entrevista | Barcelona.pm | Juliol 2013 - meis</title>

    <meta name="author" content="Marc Egea i Sala" />

    <link href="http://fonts.googleapis.com/css?family=Open+Sans:regular,semibold,italic,italicsemibold|PT+Sans:400,700,400italic,700italic|PT+Serif:400,700,400italic,700italic" rel="stylesheet" />

    <link href="css/impress-demo.css" rel="stylesheet" />
    <link href="css/default.css" rel="stylesheet" />
    <link href="css/rainbow.css" rel="stylesheet" />

    <link rel="shortcut icon" href="favicon.png" />
    <link rel="apple-touch-icon" href="apple-touch-icon.png" />
</head>

<body class="impress-not-supported">

<div class="fallback-message">
    <p>Your browser <b>doesn't support the features required</b> by impress.js, so you are presented with a simplified version of this presentation.</p>
    <p>For the best experience please use the latest <b>Chrome</b>, <b>Safari</b> or <b>Firefox</b> browser.</p>
</div>

<div id="impress">
    <div class="step froggy" data-x="-2000" data-y="-2500" data-z="0">
        <p>A long time ago in a galaxy far, far away...</p>
    </div>
    <div class="step froggy" data-x="-2000" data-y="-2500" data-z="-1000">
        <p>Bé, no fa tant.</p>
    </div>
    <div class="step froggy" data-x="-2000" data-y="-2500" data-z="-2000">
        <p>A principis de 2013.</p>
    </div>
    <div class="step froggy" data-x="-2000" data-y="-2500" data-z="-3000">
        <p>Ni tan lluny.</p>
    </div>
    <div class="step froggy" data-x="-2000" data-y="-2500" data-z="-4000">
        <p>Vaja, a Barcelona.</p>
    </div>
    <div class="step froggy" data-x="-2000" data-y="-2500" data-z="-5000">
        <p>... vaig realitzar un petit projecte</p>
    </div>
    <div class="step froggy" data-x="-2000" data-y="-2500" data-z="-6000">
        <p>... i m'agradaria compartir l'experiència.</p>
    </div>
    <div class="step froggy" data-x="-2000" data-y="-2500" data-z="-7000">
        <p>Això és...</p>
    </div>
    <div id="title" class="step" data-x="-1500" data-y="-500" data-scale="4">
        <span class="try">la</span>
        <h1>Història d'una entrevista</h1>
        <span class="footnote">(de feina)</span>
    </div>

    <div class="step froggy" data-x="0" data-y="-2500" data-z="0">
      El repte era desenvolupar <b>qualsevol cosa</b>.
    </div>
    <div class="step froggy" data-x="0" data-y="-2500" data-z="-3000">
        Utilitzant, a ser possible, les tecnologies que utilitzaven a l'empresa.
    </div>

    <div class="step froggy list" data-x="0" data-y="-2500" data-z="-8000">
      <ul>
        <li>Mojolicious</li>
        <li class="empty">&nbsp;</li>
        <li class="empty">&nbsp;</li>
        <li class="empty">&nbsp;</li>
        <li class="empty">&nbsp;</li>
      </ul>
    </div>
    <div class="step list froggy" data-x="0" data-y="-2500" data-z="-8000">
      <ul>
        <li>&nbsp;</li>
        <li>Backbone.js</li>
        <li class="empty">&nbsp;</li>
        <li class="empty">&nbsp;</li>
        <li class="empty">&nbsp;</li>
      </ul>
    </div>
    <div class="step list froggy" data-x="0" data-y="-2500" data-z="-8000">
      <ul>
        <li>&nbsp;</li>
        <li>&nbsp;</li>
        <li>Websockets</li>
        <li class="empty">&nbsp;</li>
        <li class="empty">&nbsp;</li>
      </ul>
    </div>
    <div class="step list froggy" data-x="0" data-y="-2500" data-z="-8000">
      <ul>
        <li>&nbsp;</li>
        <li>&nbsp;</li>
        <li>&nbsp;</li>
        <li>Aplicació original</li>
        <li class="empty">&nbsp;</li>
      </ul>
    </div>
    <div class="step list froggy" data-x="0" data-y="-2500" data-z="-8000">
      <ul>
        <li>&nbsp;</li>
        <li>&nbsp;</li>
        <li>&nbsp;</li>
        <li><span class="empty">Aplicació original</span>: un mud</li>
        <li class="empty">&nbsp;</li>
      </ul>
    </div>
    <div class="step list froggy" data-x="0" data-y="-2500" data-z="-8000">
      <ul>
        <li>&nbsp;</li>
        <li>&nbsp;</li>
        <li>&nbsp;</li>
        <li>&nbsp;</li>
        <li>Acabar en un temps limitat</li>
      </ul>
    </div>

    <div class="step" data-x="-1500" data-y="4300" data-rotate="120" data-scale="2">
        <strong>Mojolicious</strong> <br/>
        <p>Framework web per aplicacions en temps real escrit en Perl.</p>
        <p>Permet realitzar grans aplicacions però és molt còmode per aplicacions petites (amb menys convencions que altres frameworks que esteu pensant)</p>
        <p>Consulteu en Diego per més informació.</p>
    </div>
    <div class="step" data-x="-3000" data-y="2900" data-rotate="210" data-scale="2">
        <strong>Backbone.js</strong> <br/>
        <p>Llibreria que implementa models, vistes, coleccions i gestió d'events sobre JavaScript.</p>
        <p>Dissenyada per muntar aplicacions web en una sola pàgina.</p>
    </div>
    <div class="step" data-x="-1500" data-y="1500" data-rotate="300" data-scale="2">
        <strong>Websockets</strong> <br/>
        <p>Tecnologia que proporciona un canal de comunicació bidireccional entre el servidor i el navegador a través d'un socket TCP.</p>
        <p>La seva API es pot utilitzar sobre JavaScript i està estandaritzada, però no tots els navegadors l'implementen (FUCK IE).</p>
    </div>
    <div class="step" data-x="0" data-y="2900" data-rotate="390" data-scale="2">
        <strong>MUD</strong> <br/>
        <p><i>Multi User Dungeon</i>: joc multiusuari en temps real basat en text.</p>
        <p>Predecessors dels MMORPG, s'implementen sobre telnet i requereixen poc ample de banda.</p>
    </div>


    <div id="manythings" class="step" data-x="2500" data-y="-1900" data-rotate="270" data-scale="2">
      <p>Moltes coses...</p>
      <p><a target="_blank" href="http://localhost:3000/player/marc">ho provem</a>?</p>
    </div>


    <div id="code" class="step" data-x="7500" data-y="-1500" data-scale="8">
        <p>Ok, mirem el <b>codi</b>?</p>
        <p><a target="_blank" href="http://github.com/meis/ws-mud">http://github.com/meis/ws-mud</a></p>
        <span class="footnote">* El meu "primer" codi amb aquestes tecnologies.</span>
    </div>

    <div class="step" data-x="5900" data-y="-300" data-scale="4">
        <p>Com funciona?</p>
    </div>
    <div class="step slide" data-x="4700" data-y="300">
        <h1>Per entrendre el projecte:</h1>
        <ul class="list">
          <li>El temps i els coneixements són limitats</li>
          <li>No implemento capa de persistència</li>
          <li>No tinc pàgines de login</li>
          <li>No tinc control d'errors</li>
          <li>Intento minimitzar les dependències de peces que no conec</li>
        </ul>
    </div>
    <div class="step slide" data-x="5700" data-y="300">
        <h1>Fitxers:</h1>
<pre><code class="bash">-rw-r--r-- 1 m m      150 jul 21 19:17 ./lib/WSMud.pm
-rw-r--r-- 1 m m     1846 jul 21 19:17 ./lib/WSMud/Action.pm
-rw-r--r-- 1 m m      535 jul 21 19:17 ./lib/WSMud/Notification.pm
-rw-r--r-- 1 m m      805 jul 21 19:17 ./lib/WSMud/Player.pm
-rw-r--r-- 1 m m      265 jul 21 19:17 ./lib/WSMud/Room.pm
-rw-r--r-- 1 m m     6192 jul 21 19:17 ./lib/WSMud/World.pm
-rw-r--r-- 1 m m     1050 jul 21 19:17 ./public/css/application.css
-rw-r--r-- 1 m m   127247 jul 21 19:17 ./public/css/bootstrap.css
-rw-r--r-- 1 m m   105939 jul 21 19:17 ./public/css/bootstrap.min.css
-rw-r--r-- 1 m m    22111 jul 21 19:17 ./public/css/bootstrap-responsive.css
-rw-r--r-- 1 m m    16849 jul 21 19:17 ./public/css/bootstrap-responsive.min.css
-rw-r--r-- 1 m m    12799 jul 21 19:17 ./public/img/glyphicons-halflings.png
-rw-r--r-- 1 m m     8777 jul 21 19:17 ./public/img/glyphicons-halflings-white.png
-rw-r--r-- 1 m m    18286 jul 21 19:17 ./public/js/backbone-min.js
-rw-r--r-- 1 m m    61752 jul 21 19:17 ./public/js/bootstrap.js
-rw-r--r-- 1 m m    13450 jul 21 19:17 ./public/js/underscore-min.js
-rw-r--r-- 1 m m     4110 jul 21 19:17 ./public/js/ws-mud.js
-rw-r--r-- 1 m m      593 jul 21 19:17 ./README.md
-rw-r--r-- 1 m m     1383 jul 21 19:17 ./templates/game.html.ep
-rw-r--r-- 1 m m       45 jul 21 19:17 ./templates/index.html.ep
-rwxr-xr-x 1 m m      769 jul 21 19:17 ./ws-mud</code></pre>
    </div>
    <div class="step slide" data-x="6700" data-y="300">
        <h1>3 controladors:</h1>
<pre><code class="language-perl">  use Mojolicious::Lite;
  use WSMud;
  my $world = WSMud::World->new();

  get '/' => sub {
      my $self = shift;
      $self->render('index');
  };

  get '/player/:player_name' => sub {
      my $self = shift;  
      my $player_name = $self->param('player_name');

      $self->render('game', player_name => $player_name);
  };

  websocket '/mud/:player_name' => sub {
      my $self = shift;
      Mojo::IOLoop->stream($self->tx->connection)->timeout(300);
      my $player = WSMud::Player->new($self->param('player_name'), $world, $self);
  };

  $app->start;</code></pre>
      <q>./wsmud</q>
    </div>
    <div class="step slide" data-x="7700" data-y="300">
      <h1>Carrega del client JavaScript</h1>
<pre><code class="html">&lt;head&gt;
    &lt;title&gt;WebSocket Mud Client&lt;/title&gt;
    &lt;script&gt;<b>ws_url='ws://localhost:3000/mud/<%= $player_name %>'</b>&lt;/script&gt;
    &lt;link href="/css/bootstrap.min.css" rel="stylesheet" media="screen"&gt;    
    &lt;link href="/css/application.css" rel="stylesheet" media="screen"&gt;
    &lt;script src="http://code.jquery.com/jquery.js"&gt;&lt;/script&gt;
    &lt;script src="/js/bootstrap.min.js"&gt;&lt;/script&gt;    
    &lt;script src="/js/underscore-min.js"&gt;&lt;/script&gt;    
    &lt;script src="/js/backbone-min.js"&gt;&lt;/script&gt;    
    &lt;script src="/js/ws-mud.js"&gt;&lt;/script&gt;  
&lt;/head&gt;</code></pre>
        <q>./template/game.ep.html:</q>
    </div>
    <div class="step slide" data-x="8700" data-y="300">
        <h1>Gestió del Websocket:</h1>
<pre><code class="language-javascript">  var ws;
  var WSMud = {};
  _.extend(WSMud, Backbone.Events);
  
  WSMud.create_socket = function () {
    ws = new WebSocket(ws_url);
    
    ws.onopen = function () {  
      WSMud.trigger("connect");
    };
    
    ws.onclose = function () {
      WSMud.trigger("disconnect");
    };

    ws.onmessage = function (msg) {
      var res = JSON.parse(msg.data);      
      WSMud.trigger(res.type, res);
    };
  }

  WSMud.create_socket();</code></pre>
      <q>./public/js/ws-mud.js</q>
    </div>
    <div class="step slide" data-x="9700" data-y="300">
        <h1>Subscripció a events:</h1>
        <pre><code class="language-javascript">  var WSMud_console = {};
  _.extend(WSMud_console, Backbone.Events);

  WSMud_console.listenTo(WSMud, { 
    "connect"     : WSMud_console.connected,
    "disconnect"  : WSMud_console.disconnected,
  
    "echo"        : WSMud_console.update,
    "message"     : WSMud_console.update,
    "room:glance" : WSMud_console.update,
    "room:look"   : WSMud_console.update,
    "room:players": WSMud_console.update,
    "help"        : WSMud_console.update,
    "error"       : WSMud_console.update
  });</code></pre>
      <q>./public/js/ws-mud.js</q>
    </div>
    <div class="step slide" data-x="4700" data-y="1300">
      <h1>Gestió del Websocket:</h1>
<pre><code class="language-perl">  package WSMud::Player;
...
  sub init_connection {
      my $self    = shift;
      my $player  = $self;
      my $world   = $player->{world};
      $self->{connection}->on(message =>
          sub {$world->dispatch_action($player, $_[1])}
      );
      $self->{connection}->on(finish =>
          sub {$world->left($player)}
      );
  }
  sub notify { 
      my ($self, %attrs) = @_;
      my $notification = WSMud::Notification->new(%attrs);
      $self->{connection}->send($notification->encode);
  }
  sub disconnect {
      my $self = shift;
      $self->{connection}->finish;
  }</code></pre>
      <q>./lib/WSMud/Player.pm</q>
    </div>
    <div class="step slide" data-x="5700" data-y="1300">
        <h1>Gestió de les accions:</h1>
<pre><code class="language-perl">sub dispatch {
  my $self          = shift;  
  my $world         = shift;
  my $player        = shift;
  my $notification  = WSMud::Notification->decode(shift);
  my $type          = $notification->{type};
  my @call          = split(" ", $notification->{text});
  
  for ($type) {
    when('cmd') {
      for ($call[0]) {
        when('help') { $self->action_help($world, $player, @call); }
        when('say')  { $self->action_say($world, $player, @call); }
        when('move') { $self->action_move($world, $player, @call); }
        when('look') { $self->action_look($world, $player, @call); }  			
        when('quit') { $self->action_quit($world, $player, @call); }
        default      { $self->action_default($world, $player, @call); }
      }
    }
  }
}</code></pre>
      <q>./lib/WSMud/Action.pm</q>
    </div>

    <div class="step slide" data-x="6700" data-y="1300">
        <h1>El mapa:</h1>
        <pre><code class="language-perl">...

  $self->{zone_map}[3] = WSMud::Room->new(
      id          => 3,
      brief       => 'Blue room',
      description => 'This is a big blue room. Everything in the room is blue.',
      color       => 'blue',
      exits       => {'w' => 2, 's' => 4}
  );

  $self->{zone_map}[4] = WSMud::Room->new(
      id          => 4,
      brief       => 'Orange room',
      description => 'This is a big orange room. Everything in the room is orange.',
      color       => 'orange',
      exits       => {'w' => 1, 'n' => 3}
  );
</code></pre>
      <q>./lib/WSMud/World.pm</q>
    </div>

    <div class="step" data-x="5900" data-y="2000" data-scale="4">
        <p>Algunes coses que canviaria</p>
    </div>
    <div class="step slide" data-x="4700" data-y="2600">
        <h1>Mojolicious al repositori</h1>
        <q>Instal·lar un submodul:</q><br><br>
        <pre><code>  git submodule init
  git submodule update</code></pre><br>
        <q>Executar:</q><br><br>
        <pre><code>  perl ws-mud</code></pre><br>
        <q>Mola, però Mojo és Perl, i així no té <b>morbo</b></q><br><br>
        <pre><code>  morbo ws-mud</code></pre>
    </div>
    <div class="step slide" data-x="5700" data-y="2600">
        <h1>Passar arrays a funcions</h2>
        <pre><code class="language-perl">  $self->action_help($world, $player, @call);</code></pre><br>
        <q>T'estalvies problemes si passes referències a arrays</q><br><br>
        <pre><code class="language-perl">  $self->action_help($world, $player, $call, $another_param);</code></pre><br>
        <q>Treballant amb altres llenguatges no estàs acostumat a les referències</q>
    </div>
    <div class="step slide" data-x="6700" data-y="2600">
        <h1>Pas de paràmetres:</h1>
<pre><code class="language-perl">  my $self          = shift;
  my $world         = shift;
  my $player        = shift;
  my $notification  = WSMud::Notification->decode(shift);
  my $type          = $notification->{type};
  my @call          = split(" ", $notification->{text});</code></pre>
        <br><q>Em semblava clar (1 línia per paràmetre). Ara faria:</q><br><br>
<pre><code class="language-perl">  my ($self, $world, $player, $raw_notification) = @_;

  my $notification  = WSMud::Notification->decode($raw_notification);
  my $type          = $notification->{type};
  my $call          = [ split(" ", $notification->{text}) ];</code></pre>
    </div>
    <div class="step slide" data-x="7700" data-y="2600">
      <h1>Què és Backbone.js?</h1>
        <ul class="list">
          <li>Porta el concepte de Model al client</li>
          <li>Sincronització fàcil dels models entre client i servidor (REST)</li>
          <li>Gestiona col·leccions de models (arrays amb vitamines)</li>
          <li>Definició de l'entitat Vista</li>
          <li><b>Publicació i subscripció d'events</b></li>
        </ul>
    </div>
    <div class="step slide" data-x="8700" data-y="2600">
        <h1>Utilitzar Moose</h1>
<pre><code class="language-perl">  package WSMud::World;

  sub new {
      my $class = shift;
      my $self = {
          %online_players => {},
          @zone_map => [],
          %positions = {},
      };
      bless $self;
      $self->populate_map;
      return $self;
  }</code></pre><br>
        <q>No tinc clar ni perquè funciona. Podria ser:</q><br><br>
<pre><code class="language-perl">  package WSMud::World;
  use Moose;

  has 'online_players' => ( is => 'rw', isa => 'HashRef' );
  has 'zone_map'       => ( is => 'rw', isa => 'ArrayRef' );
  has 'positions'      => ( is => 'rw', isa => 'HashRef' ); </code></pre>
    </div>

    <div class="step slide" data-x="9700" data-y="2600">
      <h1>Implementació de les notificacions</h1>
<pre><code class="language-perl">  sub join {
      my ($self, $player) = @_;
      $player_name = $player->{name};
  
      if ($self->is_online($player)) {
          $self->notify_player($player, type => 'error', text => "This user is active, please 
choose another one.");
          $self->disconnect($player);
      } 
      else { 
          $self->add_player($player);
          $self->notify_player($player, type => 'message', text => "Welcome to the game, 
". $player_name . ".");
          $self->notify_player($player, type => 'message', text => "If you don't know what to 
do, type 'help'");        
          $self->notify_player($player, type => 'who', value => $self->who);
          $self->notify_all($player, type => 'message', text => "[$player_name enters 
the game.]");    
          $self->notify_all($player, type => 'login', value => $player_name);
          $self->enter_room($player, $self->initial_room($player));
      }
  }
</code></pre>
        <q>Massa coses de cop. Un cop funciona, refactoritzar.</q>
    </div>
    <div class="step slide" data-x="4700" data-y="3600">
      <h1>Treballem pels altres (fins i tot si som nosaltres)</h1>
      <q>Els comentaris i la documentació ajuden.</q><br><br>
      <q>L'estil en el codi ajuda a llegir: </q><br><br>
<pre><code class="language-perl">  $self->{zone_map}[4] = WSMud::Room->new(
    id        => 4,
        brief                  => 'Orange room',
        description    => 'This is a big orange room. Everything in the room is orange.',
        color                          => 'orange',
        exits                          => {'w' => 1, 'n' => 3}
  );</code></pre><br>
        <q>* Diferents editors en diferents ordinadors amb diferents configuracions.</q>
    </div>


    <div class="step" data-x="5900" data-y="4300" data-scale="4">
        <p>Coses que voldria implementar</p>
    </div>
    <div class="step slide" data-x="4700" data-y="4900">
        <h1>Hearbeat</h1>
        <div>Ara les accions son en temps real.</div><br>
        <div>S'hauria d'implementar una cua d'accions:<br><br>
          <ul class="list">
            <li>Limitar les accions per unitat de temps</li>
            <li>Assegurar l'ordre de les accions</li>
            <li>Permetre tenir accions més pesades en temps</li>
            <li>Modular el nombre d'acciones per unitat de temps</li>
          </ul>
        </div>
    </div>
    <div class="step slide" data-x="5700" data-y="4900">
        <h1>Resolució d'accions</h1>
        <ul class="list">
          <li>Resolució encadenada (player, room, world)</li>
          <li>Permetre afegir / modificar acciones (plug-ins)</li>
          <li>Dimensió temporal de les acciones</li>
          <li>Objecte de les accions (altres jugadors)</li>
        </ul>
    </div>
    <div class="step slide" data-x="6700" data-y="4900">
        <h1>Mapa de joc</h1>
        <ul class="list">
          <li>Amb persistència</li>
          <li>Representat en forma de graf</li>
          <li>Representació gràfica en el client</li>
          <li>Resolució de camins (i ponderats)</li>
        </ul>
    </div>
    <div class="step slide" data-x="7700" data-y="4900">
        <h1>Tests</h1>
        <ul class="list">
          <li>Com provar coses asíncrones?</li>
          <li>Proves de visualització al navegador</li>
        </ul>
    </div>

    <div class="step cube" data-x="2000" data-y="1500"  data-scale="2">
        <h1>Algunes conclusions</h1>
        <ul class="list">
          <li>Primer acabar, després refactoritzar. S'aprèn pel camí.</li>
          <li>És important conèixer les eines i quin propòsit tenen</li>
          <li>Sorprenentment, la revisió de decisions es positiva</li>
          <li>Els Websockets molen</li>
          <li>S'ha de compartir, encara que faci vergonya</li>
        </ul>
    </div>

    <div class="step cube" data-x="2700" data-y="1500" data-z="-700" data-scale="2"  data-rotate-y="90">
        <p>per cert...</p>
    </div>
    <div class="step cube" data-x="2000" data-y="1500" data-z="-1400" data-scale="2" data-rotate-y="180">
        <p>aquesta primavera vaig canviar de feina ;)</p>
    </div>

    <div class="step cube" data-x="1300" data-y="1500" data-z="-700" data-scale="2" data-rotate-y="270">
      <div class="finish">
        <ul>
          <li>Precs<sup>(per favor, calla ja!)</sup> i preguntes<sup>(has acabat, ja?)</sup></li>
          <li>Com ho veieu? Alguna idea?</li>
        </ul>
      </div>
    </div>

    <div id="overview" class="step" data-x="3000" data-y="1500" data-scale="10">
    </div>

</div>

<div class="hint">
    <p>Use a spacebar or arrow keys to navigate</p>
</div>
<script>
if ("ontouchstart" in document.documentElement) { 
    document.querySelector(".hint").innerHTML = "<p>Tap on the left or right to navigate</p>";
}
</script>

<script src="js/impress.js"></script>
<script src="js/highlight.pack.js"></script>
<script>impress().init();</script>
<script>hljs.initHighlightingOnLoad();</script>

</body>
</html>
